# Generated by Django 6.0.2 on 2026-02-26 21:46

import django.db.models.deletion
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('data_tracer', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='ScanComparison',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('new_findings', models.JSONField(blank=True, default=list)),
                ('resolved_findings', models.JSONField(blank=True, default=list)),
                ('unchanged_findings', models.JSONField(blank=True, default=list)),
                ('new_ports', models.JSONField(blank=True, default=list)),
                ('closed_ports', models.JSONField(blank=True, default=list)),
                ('new_services', models.JSONField(blank=True, default=list)),
                ('risk_delta', models.FloatField(default=0.0, help_text='Change in risk score (positive = worse)')),
                ('summary', models.TextField(blank=True)),
                ('compared_at', models.DateTimeField(auto_now_add=True)),
                ('baseline_scan', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='baseline_comparisons', to='data_tracer.scanresult')),
                ('compared_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('comparison_scan', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='comparison_results', to='data_tracer.scanresult')),
            ],
            options={
                'ordering': ['-compared_at'],
            },
        ),
        migrations.CreateModel(
            name='APIEndpoint',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('url', models.URLField(max_length=2000)),
                ('path', models.CharField(max_length=1000)),
                ('method', models.CharField(choices=[('GET', 'GET'), ('POST', 'POST'), ('PUT', 'PUT'), ('PATCH', 'PATCH'), ('DELETE', 'DELETE'), ('OPTIONS', 'OPTIONS'), ('HEAD', 'HEAD')], default='GET', max_length=10)),
                ('endpoint_type', models.CharField(blank=True, max_length=50)),
                ('auth_required', models.BooleanField(null=True)),
                ('status_code', models.IntegerField(blank=True, null=True)),
                ('security_findings', models.JSONField(blank=True, default=list)),
                ('parameters', models.JSONField(blank=True, default=list)),
                ('response_schema', models.JSONField(blank=True, default=dict)),
                ('discovered_at', models.DateTimeField(auto_now_add=True)),
                ('scan_result', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='api_endpoints', to='data_tracer.scanresult')),
            ],
            options={
                'ordering': ['-discovered_at'],
                'indexes': [models.Index(fields=['scan_result', 'endpoint_type'], name='data_tracer_scan_re_8d6746_idx')],
            },
        ),
        migrations.CreateModel(
            name='CloudAsset',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('provider', models.CharField(choices=[('aws', 'Amazon Web Services'), ('azure', 'Microsoft Azure'), ('gcp', 'Google Cloud Platform'), ('other', 'Other')], db_index=True, max_length=10)),
                ('asset_type', models.CharField(db_index=True, max_length=100)),
                ('asset_id', models.CharField(max_length=500)),
                ('asset_name', models.CharField(blank=True, max_length=500)),
                ('region', models.CharField(blank=True, max_length=100)),
                ('is_public', models.BooleanField(default=False)),
                ('security_findings', models.JSONField(blank=True, default=list)),
                ('compliance_status', models.JSONField(blank=True, default=dict)),
                ('risk_score', models.FloatField(default=0.0)),
                ('tags', models.JSONField(blank=True, default=dict)),
                ('discovered_at', models.DateTimeField(auto_now_add=True)),
                ('scan_result', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='cloud_assets', to='data_tracer.scanresult')),
            ],
            options={
                'ordering': ['-risk_score', '-discovered_at'],
                'indexes': [models.Index(fields=['scan_result', 'provider'], name='data_tracer_scan_re_632e84_idx'), models.Index(fields=['asset_type'], name='data_tracer_asset_t_b414c6_idx'), models.Index(fields=['is_public'], name='data_tracer_is_publ_946cea_idx')],
            },
        ),
        migrations.CreateModel(
            name='CredentialFinding',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('finding_type', models.CharField(choices=[('default_credentials', 'Default Credentials'), ('exposed_secret', 'Exposed Secret'), ('weak_password', 'Weak Password'), ('password_in_url', 'Password in URL'), ('cleartext_auth', 'Cleartext Authentication'), ('certificate_issue', 'Certificate Issue'), ('hash_found', 'Password Hash Found')], db_index=True, max_length=30)),
                ('severity', models.CharField(choices=[('critical', 'Critical'), ('high', 'High'), ('medium', 'Medium'), ('low', 'Low'), ('info', 'Informational')], db_index=True, default='high', max_length=10)),
                ('service', models.CharField(blank=True, max_length=100)),
                ('username', models.CharField(blank=True, max_length=255)),
                ('secret_type', models.CharField(blank=True, max_length=100)),
                ('secret_value_redacted', models.CharField(blank=True, max_length=500)),
                ('source_url', models.CharField(blank=True, max_length=2000)),
                ('description', models.TextField(blank=True)),
                ('remediation', models.TextField(blank=True)),
                ('discovered_at', models.DateTimeField(auto_now_add=True)),
                ('scan_result', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='credential_findings', to='data_tracer.scanresult')),
            ],
            options={
                'ordering': ['-discovered_at'],
                'indexes': [models.Index(fields=['scan_result', 'severity'], name='data_tracer_scan_re_f6f7bc_idx'), models.Index(fields=['finding_type'], name='data_tracer_finding_1c0382_idx')],
            },
        ),
        migrations.CreateModel(
            name='NetworkTopology',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('ip_address', models.GenericIPAddressField()),
                ('mac_address', models.CharField(blank=True, max_length=17)),
                ('hostname', models.CharField(blank=True, max_length=255)),
                ('node_type', models.CharField(choices=[('server', 'Server'), ('workstation', 'Workstation'), ('network_equipment', 'Network Equipment'), ('printer', 'Printer'), ('iot', 'IoT Device'), ('unknown', 'Unknown')], default='unknown', max_length=20)),
                ('vendor', models.CharField(blank=True, max_length=200)),
                ('os_guess', models.CharField(blank=True, max_length=200)),
                ('open_ports', models.JSONField(blank=True, default=list)),
                ('services', models.JSONField(blank=True, default=list)),
                ('graph_data', models.JSONField(blank=True, default=dict, help_text='D3.js-compatible node data')),
                ('discovered_at', models.DateTimeField(auto_now_add=True)),
                ('scan_result', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='topology_nodes', to='data_tracer.scanresult')),
            ],
            options={
                'ordering': ['ip_address'],
                'indexes': [models.Index(fields=['scan_result', 'ip_address'], name='data_tracer_scan_re_1b9434_idx'), models.Index(fields=['node_type'], name='data_tracer_node_ty_0ba671_idx')],
            },
        ),
        migrations.CreateModel(
            name='ScanReport',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('title', models.CharField(max_length=300)),
                ('format', models.CharField(choices=[('json', 'JSON'), ('html', 'HTML'), ('pdf', 'PDF'), ('csv', 'CSV'), ('markdown', 'Markdown'), ('text', 'Plain Text')], default='html', max_length=10)),
                ('content', models.TextField(blank=True)),
                ('executive_summary', models.JSONField(blank=True, default=dict)),
                ('risk_score', models.FloatField(default=0.0)),
                ('finding_count', models.IntegerField(default=0)),
                ('critical_count', models.IntegerField(default=0)),
                ('high_count', models.IntegerField(default=0)),
                ('compliance_data', models.JSONField(blank=True, default=dict)),
                ('generated_at', models.DateTimeField(auto_now_add=True)),
                ('generated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('scan_result', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='reports', to='data_tracer.scanresult')),
            ],
            options={
                'ordering': ['-generated_at'],
                'indexes': [models.Index(fields=['scan_result', 'generated_at'], name='data_tracer_scan_re_721ce8_idx'), models.Index(fields=['format'], name='data_tracer_format_48d103_idx')],
            },
        ),
        migrations.CreateModel(
            name='ScanSchedule',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('name', models.CharField(max_length=200)),
                ('target', models.CharField(max_length=255)),
                ('scan_type', models.CharField(default='comprehensive', max_length=50)),
                ('frequency', models.CharField(choices=[('once', 'Run Once'), ('hourly', 'Hourly'), ('daily', 'Daily'), ('weekly', 'Weekly'), ('monthly', 'Monthly')], default='once', max_length=10)),
                ('next_run', models.DateTimeField(blank=True, null=True)),
                ('last_run', models.DateTimeField(blank=True, null=True)),
                ('is_active', models.BooleanField(default=True)),
                ('scan_config', models.JSONField(blank=True, default=dict)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('created_by', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='scan_schedules', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['next_run'],
                'indexes': [models.Index(fields=['is_active', 'next_run'], name='data_tracer_is_acti_710001_idx'), models.Index(fields=['created_by'], name='data_tracer_created_c651ee_idx')],
            },
        ),
        migrations.CreateModel(
            name='ThreatIntelligence',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('ioc_type', models.CharField(choices=[('ip', 'IP Address'), ('domain', 'Domain'), ('url', 'URL'), ('hash', 'File Hash'), ('email', 'Email'), ('yara', 'YARA Match')], db_index=True, max_length=10)),
                ('ioc_value', models.CharField(db_index=True, max_length=500)),
                ('threat_score', models.IntegerField(default=0)),
                ('severity', models.CharField(choices=[('critical', 'Critical'), ('high', 'High'), ('medium', 'Medium'), ('low', 'Low'), ('info', 'Informational')], default='info', max_length=10)),
                ('categories', models.JSONField(blank=True, default=list)),
                ('threat_feeds', models.JSONField(blank=True, default=list)),
                ('mitre_techniques', models.JSONField(blank=True, default=list)),
                ('reputation_data', models.JSONField(blank=True, default=dict)),
                ('first_seen', models.DateTimeField(blank=True, null=True)),
                ('last_seen', models.DateTimeField(blank=True, null=True)),
                ('discovered_at', models.DateTimeField(auto_now_add=True)),
                ('scan_result', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='threat_intel_matches', to='data_tracer.scanresult')),
            ],
            options={
                'ordering': ['-threat_score', '-discovered_at'],
                'indexes': [models.Index(fields=['scan_result', 'ioc_type'], name='data_tracer_scan_re_1f9676_idx'), models.Index(fields=['threat_score'], name='data_tracer_threat__4192e3_idx')],
            },
        ),
        migrations.CreateModel(
            name='TrafficFlow',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('flow_id', models.CharField(blank=True, db_index=True, max_length=64)),
                ('source_ip', models.GenericIPAddressField()),
                ('destination_ip', models.GenericIPAddressField()),
                ('source_port', models.IntegerField(blank=True, null=True)),
                ('destination_port', models.IntegerField(blank=True, null=True)),
                ('protocol', models.CharField(choices=[('tcp', 'TCP'), ('udp', 'UDP'), ('icmp', 'ICMP'), ('other', 'Other')], default='tcp', max_length=10)),
                ('application_protocol', models.CharField(blank=True, max_length=50)),
                ('packet_count', models.IntegerField(default=0)),
                ('byte_count', models.BigIntegerField(default=0)),
                ('flow_state', models.CharField(default='unknown', max_length=20)),
                ('anomalies', models.JSONField(blank=True, default=list)),
                ('extracted_data', models.JSONField(blank=True, default=dict)),
                ('start_time', models.DateTimeField(auto_now_add=True)),
                ('end_time', models.DateTimeField(blank=True, null=True)),
                ('scan_result', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='traffic_flows', to='data_tracer.scanresult')),
            ],
            options={
                'ordering': ['-byte_count'],
                'indexes': [models.Index(fields=['scan_result', 'start_time'], name='data_tracer_scan_re_ee235c_idx'), models.Index(fields=['source_ip', 'destination_ip'], name='data_tracer_source__de0581_idx'), models.Index(fields=['application_protocol'], name='data_tracer_applica_f0a41c_idx')],
            },
        ),
        migrations.CreateModel(
            name='VulnerabilityFinding',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('cve_id', models.CharField(blank=True, db_index=True, max_length=30)),
                ('cvss_score', models.FloatField(blank=True, null=True)),
                ('severity', models.CharField(choices=[('critical', 'Critical'), ('high', 'High'), ('medium', 'Medium'), ('low', 'Low'), ('info', 'Informational')], db_index=True, default='info', max_length=10)),
                ('title', models.CharField(max_length=300)),
                ('description', models.TextField(blank=True)),
                ('affected_component', models.CharField(blank=True, max_length=500)),
                ('remediation', models.TextField(blank=True)),
                ('exploit_available', models.BooleanField(default=False)),
                ('vulnerability_type', models.CharField(blank=True, max_length=100)),
                ('references', models.JSONField(blank=True, default=list)),
                ('discovered_at', models.DateTimeField(auto_now_add=True)),
                ('scan_result', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='vulnerability_findings', to='data_tracer.scanresult')),
            ],
            options={
                'ordering': ['-cvss_score', '-discovered_at'],
                'indexes': [models.Index(fields=['scan_result', 'severity'], name='data_tracer_scan_re_296352_idx'), models.Index(fields=['cve_id'], name='data_tracer_cve_id_c372e4_idx')],
            },
        ),
        migrations.CreateModel(
            name='WirelessNetwork',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('ssid', models.CharField(blank=True, max_length=255)),
                ('bssid', models.CharField(max_length=17)),
                ('channel', models.IntegerField(blank=True, null=True)),
                ('frequency', models.IntegerField(blank=True, help_text='Frequency in MHz', null=True)),
                ('signal_dbm', models.IntegerField(blank=True, null=True)),
                ('encryption', models.CharField(choices=[('WPA3', 'WPA3'), ('WPA2', 'WPA2'), ('WPA2-EAP', 'WPA2-EAP (Enterprise)'), ('WPA', 'WPA'), ('WEP', 'WEP'), ('OPEN', 'Open (No Encryption)'), ('UNKNOWN', 'Unknown')], default='UNKNOWN', max_length=10)),
                ('wps_enabled', models.BooleanField(default=False)),
                ('hidden', models.BooleanField(default=False)),
                ('vendor', models.CharField(blank=True, max_length=200)),
                ('risk_level', models.CharField(choices=[('critical', 'Critical'), ('high', 'High'), ('medium', 'Medium'), ('low', 'Low'), ('unknown', 'Unknown')], db_index=True, default='unknown', max_length=10)),
                ('security_findings', models.JSONField(blank=True, default=list)),
                ('is_rogue', models.BooleanField(default=False)),
                ('discovered_at', models.DateTimeField(auto_now_add=True)),
                ('scan_result', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='wireless_networks', to='data_tracer.scanresult')),
            ],
            options={
                'ordering': ['-discovered_at'],
                'indexes': [models.Index(fields=['scan_result', 'risk_level'], name='data_tracer_scan_re_3576ec_idx'), models.Index(fields=['encryption'], name='data_tracer_encrypt_aacace_idx'), models.Index(fields=['is_rogue'], name='data_tracer_is_rogu_7bc07e_idx')],
            },
        ),
    ]

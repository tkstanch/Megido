{% extends "admin/base_site.html" %}
{% load static %}

{% block content %}
<div style="padding: 20px;">
    <h1>{{ title }}</h1>
    
    <div style="margin: 20px 0;">
        <h2>Vulnerability Details</h2>
        <table style="width: 100%; border-collapse: collapse;">
            <tr>
                <th style="text-align: left; padding: 8px; border: 1px solid #ddd;">Field</th>
                <th style="text-align: left; padding: 8px; border: 1px solid #ddd;">Value</th>
            </tr>
            <tr>
                <td style="padding: 8px; border: 1px solid #ddd;"><strong>Attack Type:</strong></td>
                <td style="padding: 8px; border: 1px solid #ddd;">{{ vulnerability.get_attack_type_display }}</td>
            </tr>
            <tr>
                <td style="padding: 8px; border: 1px solid #ddd;"><strong>Target URL:</strong></td>
                <td style="padding: 8px; border: 1px solid #ddd;">{{ vulnerability.target_url }}</td>
            </tr>
            <tr>
                <td style="padding: 8px; border: 1px solid #ddd;"><strong>Payload:</strong></td>
                <td style="padding: 8px; border: 1px solid #ddd;"><code>{{ vulnerability.payload }}</code></td>
            </tr>
            <tr>
                <td style="padding: 8px; border: 1px solid #ddd;"><strong>Status Code:</strong></td>
                <td style="padding: 8px; border: 1px solid #ddd;">{{ vulnerability.response_status_code }}</td>
            </tr>
            <tr>
                <td style="padding: 8px; border: 1px solid #ddd;"><strong>Detected At:</strong></td>
                <td style="padding: 8px; border: 1px solid #ddd;">{{ vulnerability.detected_at }}</td>
            </tr>
        </table>
    </div>
    
    <div style="margin: 20px 0;">
        <h2>HTML Evidence (Sandboxed)</h2>
        <p style="color: #666; font-size: 12px;">
            This iframe is sandboxed to prevent any malicious scripts from executing.
            All JavaScript, forms, and popups are disabled.
        </p>
        <iframe 
            sandbox="" 
            style="width: 100%; height: 600px; border: 2px solid #333; background: white;"
            srcdoc="{{ vulnerability.evidence_html|escape }}">
        </iframe>
    </div>
    
    <div style="margin: 20px 0;">
        <a href="{% url 'admin:response_analyser_vulnerability_changelist' %}" class="button">
            &larr; Back to Vulnerability List
        </a>
    </div>
</div>
{% endblock %}

"""
Migration to add new vulnerability types to the Vulnerability model.

Adds: idor, jwt, crlf, host_header, smuggling, deserialization,
      graphql, websocket, cache_poisoning, cors
"""

from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('scanner', '0010_add_visual_proof_diagnostics'),
    ]

    operations = [
        migrations.AlterField(
            model_name='vulnerability',
            name='vulnerability_type',
            field=models.CharField(
                max_length=50,
                choices=[
                    ('xss', 'Cross-Site Scripting (XSS)'),
                    ('sqli', 'SQL Injection'),
                    ('csrf', 'Cross-Site Request Forgery'),
                    ('xxe', 'XML External Entity'),
                    ('rce', 'Remote Code Execution'),
                    ('lfi', 'Local File Inclusion'),
                    ('rfi', 'Remote File Inclusion'),
                    ('open_redirect', 'Open Redirect'),
                    ('ssrf', 'Server-Side Request Forgery'),
                    ('info_disclosure', 'Information Disclosure'),
                    ('clickjacking', 'UI Redress (Clickjacking)'),
                    ('js_hijacking', 'JavaScript Hijacking / JSONP Data Exposure'),
                    ('idor', 'Insecure Direct Object Reference'),
                    ('jwt', 'JWT Security Issue'),
                    ('crlf', 'CRLF Injection'),
                    ('host_header', 'Host Header Injection'),
                    ('smuggling', 'HTTP Request Smuggling'),
                    ('deserialization', 'Insecure Deserialization'),
                    ('graphql', 'GraphQL Security Issue'),
                    ('websocket', 'WebSocket Security Issue'),
                    ('cache_poisoning', 'Web Cache Poisoning'),
                    ('cors', 'CORS Misconfiguration'),
                    ('other', 'Other'),
                ],
            ),
        ),
    ]

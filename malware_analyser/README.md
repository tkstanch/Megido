# Malware Analyser Django App

## ⚠️ CRITICAL SAFETY AND LEGAL NOTICE ⚠️

**THIS IS A DEMONSTRATION SYSTEM USING STUB IMPLEMENTATIONS.**

**NO ACTUAL MALWARE IS CREATED, ANALYZED, OR DISTRIBUTED BY THIS APPLICATION.**

---

## Legal Warnings

### Criminal Liability
Creating, distributing, or using malware without proper authorization is **ILLEGAL** in most jurisdictions and can result in severe criminal penalties including:

- **United States**: Computer Fraud and Abuse Act (CFAA) - Up to 10+ years imprisonment
- **United Kingdom**: Computer Misuse Act 1990 - Up to 10 years imprisonment
- **European Union**: Council of Europe Convention on Cybercrime
- **International**: Various national laws criminalizing unauthorized computer access

### Legal Requirements for Use
1. **Authorization**: You MUST have explicit written authorization before:
   - Creating any test malware artifacts
   - Testing security controls
   - Scanning any systems or files
   - Conducting penetration testing

2. **Compliance**: Ensure compliance with:
   - Organizational security policies
   - Data protection regulations (GDPR, CCPA, etc.)
   - Industry-specific regulations (HIPAA, PCI-DSS, etc.)
   - Local and international laws

3. **Documentation**: Maintain comprehensive audit logs of:
   - All test artifact creation
   - Authorization approvals
   - Testing activities
   - Access to sensitive functionality

---

## Ethical Guidelines

### Responsible Use
- **Purpose**: Only use for legitimate security research, testing, and educational purposes
- **Environment**: Only deploy in isolated, authorized testing environments
- **Disclosure**: Follow responsible disclosure practices for any vulnerabilities discovered
- **Privacy**: Respect user privacy and data protection laws
- **Harm Prevention**: Never use capabilities to cause harm to systems or individuals

### Professional Standards
- Follow IEEE, ACM, or other relevant professional codes of ethics
- Obtain proper security clearances where required
- Participate in security community responsibly
- Share knowledge to improve collective security

---

## Technical Implementation

### Architecture Overview
This Django app provides a demonstration platform for:
- File upload and storage (all file types accepted)
- Malware signature management
- Signature-based scanning (STUB)
- Heuristic analysis (STUB)
- Malware cleaning/removal (STUB)
- Test artifact creation (STUB - benign only)
- Comprehensive audit logging

### STUB Implementation Notice
**ALL SCANNING AND MALWARE-RELATED FUNCTIONALITY USES PLACEHOLDER CODE.**

Real implementation would require integration with:
- Antivirus engines (ClamAV, VirusTotal API, etc.)
- YARA rule matching systems
- Sandboxing platforms (Cuckoo, ANY.RUN, etc.)
- Behavioral analysis tools
- Threat intelligence platforms (MISP, OpenCTI, etc.)
- Machine learning models for detection

---

## Installation

### Prerequisites
- Python 3.8+
- Django 6.0+
- PostgreSQL or SQLite database

### Setup Steps

1. **Ensure app is in INSTALLED_APPS** (already done):
```python
INSTALLED_APPS = [
    # ... other apps ...
    'malware_analyser',
]
```

2. **Add URL configuration** (already done):
```python
path('malware-analyser/', include('malware_analyser.urls')),
```

3. **Run migrations**:
```bash
python manage.py makemigrations malware_analyser
python manage.py migrate
```

4. **Create superuser for testing**:
```bash
python manage.py createsuperuser
```

5. **Collect static files**:
```bash
python manage.py collectstatic
```

---

## Features

### 1. File Upload and Scanning
- **Accepts all file types** as per requirements
- Secure storage with UUID filenames
- Automatic hash calculation (MD5, SHA-256)
- MIME type detection
- Access control (users can only access their own files)

### 2. Signature-Based Detection (STUB)
- Manage malware signatures in database
- Hash-based matching
- Pattern-based detection
- YARA rule support (placeholder)
- Severity classification

### 3. Heuristic Analysis (STUB)
- File structure analysis (placeholder)
- Behavioral pattern detection (placeholder)
- Entropy analysis (placeholder)
- Suspicious indicator flagging (placeholder)

### 4. Malware Cleaning/Removal (STUB)
- Quarantine functionality (placeholder)
- Safe file deletion (placeholder)
- Disinfection attempts (placeholder)
- Restoration from quarantine (placeholder)

### 5. Test Artifact Creation
**⚠️ RESTRICTED TO STAFF/SUPERUSERS ONLY**

- EICAR test file generation (industry-standard, safe)
- Custom benign test patterns
- Comprehensive authorization tracking
- Purpose documentation required
- Full audit logging

### 6. Audit Logging
- All actions logged with timestamps
- User tracking
- IP address recording
- Success/failure status
- Detailed action information
- Immutable logs (cannot be deleted from admin)

### 7. Admin Integration
- Full admin interface for all models
- Read-only fields for critical data
- Filter and search capabilities
- Bulk operations where appropriate
- Permission-based access control

---

## Usage

### For Regular Users

1. **Upload a File**:
   - Navigate to `/malware-analyser/`
   - Click "Upload File for Scanning"
   - Select any file type
   - File is automatically stored securely

2. **Scan the File**:
   - Choose scan type (Signature, Heuristic, or Full)
   - Click "Start Scan"
   - Results displayed immediately (STUB - instant)

3. **View Results**:
   - See threat status (Clean/Infected)
   - Review matched signatures
   - View detailed scan information

4. **Clean Infected Files** (if applicable):
   - Quarantine the file
   - Delete the file
   - Attempt cleaning/disinfection

### For Staff/Superusers

5. **Manage Signatures**:
   - Add new malware signatures
   - Configure detection rules
   - Set severity levels
   - Activate/deactivate signatures

6. **Create Test Artifacts** ⚠️:
   - **READ ALL WARNINGS FIRST**
   - Document purpose and authorization
   - Generate benign test files
   - EICAR test string (safe, industry-standard)
   - Track all test artifacts

---

## API Endpoints

All endpoints require authentication:

- `GET /malware-analyser/` - Dashboard
- `GET/POST /malware-analyser/upload/` - Upload file
- `GET/POST /malware-analyser/scan/<file_id>/` - Scan file
- `GET /malware-analyser/results/<scan_id>/` - View results
- `POST /malware-analyser/clean/<file_id>/` - Clean file
- `GET/POST /malware-analyser/signatures/` - Manage signatures (staff only)
- `GET/POST /malware-analyser/test-malware/create/` - Create test artifact (staff only)
- `GET /malware-analyser/test-malware/<artifact_id>/` - View test artifact (staff only)

---

## Security Considerations

### File Upload Security
- All file types accepted (per requirements)
- UUID-based filenames prevent path traversal
- Original filenames sanitized
- File size limits should be configured
- Virus scanning on upload (stub - should be real in production)

### Access Control
- Users can only access their own files
- Staff/superusers have additional permissions
- Test artifact creation requires staff privileges
- Admin functions require appropriate permissions

### Data Protection
- File hashes calculated for identification
- Original filenames preserved but sanitized
- Upload timestamps tracked
- User associations maintained

### Audit Trail
- Comprehensive logging of all actions
- Immutable audit logs
- IP address tracking
- User agent recording
- Success/failure status

---

## Testing

Run unit tests:
```bash
python manage.py test malware_analyser
```

Tests cover:
- Model creation and relationships
- File upload functionality
- Signature-based scanning (stub)
- Heuristic scanning (stub)
- Cleaning operations (stub)
- Authorization for test artifacts
- Access control
- Audit logging

---

## Production Deployment Considerations

### DO NOT USE AS-IS IN PRODUCTION

This is a demonstration system. For production use, you would need:

1. **Real Malware Detection**:
   - Integration with commercial or open-source AV engines
   - YARA rule compilation and matching
   - Sandboxing integration
   - Threat intelligence feeds
   - Regular signature updates

2. **Enhanced Security**:
   - Isolated scanning environment (containerization)
   - Air-gapped systems for test artifacts
   - Multi-factor authentication for sensitive operations
   - Role-based access control (RBAC)
   - Encryption at rest and in transit

3. **Compliance**:
   - Legal review of all features
   - Compliance verification (SOC2, ISO 27001, etc.)
   - Data retention policies
   - Incident response procedures
   - Regular security audits

4. **Performance**:
   - Asynchronous scanning (Celery tasks)
   - Caching for signatures
   - Database optimization
   - File storage optimization (S3, etc.)
   - Load balancing

5. **Monitoring**:
   - Real-time alerting
   - Performance metrics
   - Error tracking
   - Security event monitoring
   - Compliance reporting

---

## Support and Contact

This is a demonstration application created for educational purposes.

For questions about security testing and malware analysis:
- Consult with qualified security professionals
- Review OWASP guidelines
- Follow SANS Institute best practices
- Engage legal counsel for compliance questions

---

## License

[Specify appropriate license]

---

## Disclaimer

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED. THE AUTHORS AND COPYRIGHT HOLDERS SHALL NOT BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY ARISING FROM THE USE OF THIS SOFTWARE.

Users are solely responsible for ensuring their use complies with all applicable laws, regulations, and ethical guidelines.

**NO ACTUAL MALWARE IS CREATED OR DISTRIBUTED BY THIS SOFTWARE.**

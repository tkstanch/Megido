# Generated by Django 6.0.2 on 2026-02-12 16:43

import django.db.models.deletion
import uuid
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('malware_analyser', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='AnalysisTechnique',
            fields=[
                ('technique_id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True)),
                ('name', models.CharField(help_text='Technique name', max_length=255)),
                ('category', models.CharField(choices=[('basic_static', 'Basic Static Analysis'), ('basic_dynamic', 'Basic Dynamic Analysis'), ('advanced_static', 'Advanced Static Analysis'), ('advanced_dynamic', 'Advanced Dynamic Analysis')], max_length=50)),
                ('description', models.TextField(help_text='Detailed description of the technique')),
                ('guidance', models.TextField(help_text='Step-by-step guidance for applying this technique')),
                ('tools_required', models.JSONField(blank=True, default=list, help_text='List of tools needed')),
                ('documentation_url', models.URLField(blank=True, help_text='Link to detailed documentation')),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'ordering': ['category', 'name'],
            },
        ),
        migrations.CreateModel(
            name='BestPractice',
            fields=[
                ('practice_id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True)),
                ('title', models.CharField(help_text='Best practice title', max_length=255)),
                ('category', models.CharField(choices=[('isolation', 'Isolation & Containment'), ('vm_setup', 'Virtual Machine Setup'), ('networking', 'Network Configuration'), ('snapshots', 'Snapshots & Backups'), ('monitoring', 'Monitoring & Logging'), ('cleanup', 'Cleanup & Disposal'), ('legal', 'Legal & Compliance'), ('general', 'General Safety')], max_length=50)),
                ('description', models.TextField(help_text='Detailed description of the best practice')),
                ('checklist_items', models.JSONField(default=list, help_text='List of checklist items')),
                ('severity', models.CharField(choices=[('critical', 'Critical'), ('high', 'High'), ('medium', 'Medium'), ('low', 'Low')], default='medium', max_length=20)),
                ('is_mandatory', models.BooleanField(default=False, help_text='Must be acknowledged before analysis')),
                ('display_order', models.IntegerField(default=0)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'ordering': ['display_order', 'category'],
            },
        ),
        migrations.CreateModel(
            name='MalwareType',
            fields=[
                ('type_id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True)),
                ('name', models.CharField(help_text='Malware type/family name', max_length=255)),
                ('category', models.CharField(choices=[('virus', 'Virus'), ('worm', 'Worm'), ('trojan', 'Trojan'), ('ransomware', 'Ransomware'), ('spyware', 'Spyware'), ('adware', 'Adware'), ('rootkit', 'Rootkit'), ('backdoor', 'Backdoor'), ('botnet', 'Botnet'), ('keylogger', 'Keylogger'), ('cryptominer', 'Cryptominer'), ('rat', 'Remote Access Trojan (RAT)'), ('dropper', 'Dropper'), ('loader', 'Loader'), ('other', 'Other')], max_length=50)),
                ('description', models.TextField(help_text='Description of this malware type')),
                ('characteristics', models.JSONField(default=dict, help_text='Key characteristics and behaviors')),
                ('detection_patterns', models.JSONField(default=list, help_text='Detection patterns for classification')),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(auto_now_add=True)),
            ],
            options={
                'ordering': ['category', 'name'],
            },
        ),
        migrations.CreateModel(
            name='AnalysisGoal',
            fields=[
                ('goal_id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True)),
                ('name', models.CharField(help_text='Goal name/title', max_length=255)),
                ('goal_type', models.CharField(choices=[('identification', 'Malware Identification'), ('functionality', 'Functionality Analysis'), ('iocs', 'IOC Extraction'), ('attribution', 'Attribution & Origin'), ('behavior', 'Behavior Analysis'), ('impact', 'Impact Assessment'), ('custom', 'Custom Goal')], default='identification', max_length=50)),
                ('description', models.TextField(help_text='Detailed description of the analysis goal')),
                ('priority', models.IntegerField(choices=[(1, 'Critical'), (2, 'High'), (3, 'Medium'), (4, 'Low')], default=3, help_text='Goal priority level')),
                ('is_default', models.BooleanField(default=False, help_text='Default goal for new analyses')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='analysis_goals', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'ordering': ['priority', '-created_at'],
            },
        ),
        migrations.CreateModel(
            name='DynamicAnalysisResult',
            fields=[
                ('analysis_id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True)),
                ('sandbox_status', models.CharField(choices=[('pending', 'Pending'), ('running', 'Running'), ('completed', 'Completed'), ('failed', 'Failed'), ('timeout', 'Timeout')], default='pending', max_length=50)),
                ('execution_time', models.FloatField(blank=True, help_text='Execution time in seconds', null=True)),
                ('processes_created', models.JSONField(default=list, help_text='Processes created during execution')),
                ('child_processes', models.JSONField(default=list)),
                ('files_created', models.JSONField(default=list)),
                ('files_modified', models.JSONField(default=list)),
                ('files_deleted', models.JSONField(default=list)),
                ('registry_keys_created', models.JSONField(default=list)),
                ('registry_keys_modified', models.JSONField(default=list)),
                ('registry_keys_deleted', models.JSONField(default=list)),
                ('network_connections', models.JSONField(default=list, help_text='Network connections made')),
                ('dns_queries', models.JSONField(default=list)),
                ('http_requests', models.JSONField(default=list)),
                ('anti_vm_detected', models.BooleanField(default=False)),
                ('anti_debug_detected', models.BooleanField(default=False)),
                ('injection_detected', models.BooleanField(default=False)),
                ('evasion_attempts', models.JSONField(default=list)),
                ('suspicious_api_calls', models.JSONField(default=list)),
                ('api_trace', models.JSONField(default=list, help_text='Traced API calls')),
                ('memory_dumps', models.JSONField(default=list, help_text='Memory dump file paths')),
                ('memory_iocs', models.JSONField(default=list, help_text='IOCs extracted from memory')),
                ('analyzed_at', models.DateTimeField(auto_now_add=True)),
                ('scan_result', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='dynamic_analysis', to='malware_analyser.scanresult')),
                ('techniques_used', models.ManyToManyField(blank=True, related_name='dynamic_analyses', to='malware_analyser.analysistechnique')),
            ],
            options={
                'ordering': ['-analyzed_at'],
            },
        ),
        migrations.CreateModel(
            name='AnalysisReport',
            fields=[
                ('report_id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True)),
                ('confidence_score', models.FloatField(default=0.0, help_text='Classification confidence (0-1)')),
                ('indicators_of_compromise', models.JSONField(default=dict, help_text='Extracted IOCs')),
                ('executive_summary', models.TextField(blank=True)),
                ('detailed_findings', models.TextField(blank=True)),
                ('recommendations', models.TextField(blank=True)),
                ('report_format', models.CharField(choices=[('json', 'JSON'), ('html', 'HTML'), ('pdf', 'PDF')], default='json', max_length=20)),
                ('report_file', models.FileField(blank=True, null=True, upload_to='analysis_reports/')),
                ('created_at', models.DateTimeField(auto_now_add=True)),
                ('created_by', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='analysis_reports', to=settings.AUTH_USER_MODEL)),
                ('goals_met', models.ManyToManyField(blank=True, related_name='reports', to='malware_analyser.analysisgoal')),
                ('scan_result', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='reports', to='malware_analyser.scanresult')),
                ('techniques_applied', models.ManyToManyField(blank=True, related_name='reports', to='malware_analyser.analysistechnique')),
                ('malware_types', models.ManyToManyField(blank=True, related_name='reports', to='malware_analyser.malwaretype')),
            ],
            options={
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='StaticAnalysisResult',
            fields=[
                ('analysis_id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False, unique=True)),
                ('md5_hash', models.CharField(blank=True, max_length=32)),
                ('sha1_hash', models.CharField(blank=True, max_length=40)),
                ('sha256_hash', models.CharField(blank=True, max_length=64)),
                ('strings_extracted', models.TextField(blank=True, help_text='Extracted strings from file')),
                ('suspicious_strings', models.JSONField(default=list, help_text='Suspicious strings identified')),
                ('pe_data', models.JSONField(blank=True, default=dict, help_text='PE header information')),
                ('dependencies', models.JSONField(default=list, help_text='DLL dependencies')),
                ('imports', models.JSONField(default=list, help_text='Imported functions')),
                ('exports', models.JSONField(default=list, help_text='Exported functions')),
                ('is_packed', models.BooleanField(default=False)),
                ('packer_detected', models.CharField(blank=True, max_length=255)),
                ('entropy', models.FloatField(blank=True, help_text='File entropy (0-8)', null=True)),
                ('unpacking_suggestions', models.TextField(blank=True)),
                ('yara_matches', models.JSONField(default=list, help_text='Matched YARA rules')),
                ('sigma_matches', models.JSONField(default=list, help_text='Matched Sigma rules')),
                ('disassembly_summary', models.TextField(blank=True)),
                ('code_similarity_matches', models.JSONField(default=list, help_text='Similar code samples found')),
                ('analyzed_at', models.DateTimeField(auto_now_add=True)),
                ('scan_result', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='static_analysis', to='malware_analyser.scanresult')),
                ('techniques_used', models.ManyToManyField(blank=True, related_name='static_analyses', to='malware_analyser.analysistechnique')),
            ],
            options={
                'ordering': ['-analyzed_at'],
            },
        ),
    ]

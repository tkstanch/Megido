"""
URL configuration for malware_analyser app.
"""
from django.urls import path
from . import views

app_name = 'malware_analyser'

urlpatterns = [
    # Main pages
    path('', views.malware_home, name='home'),
    path('upload/', views.upload_file, name='upload'),
    path('history/', views.scan_history, name='history'),
    
    # Scan operations
    path('scan/<uuid:scan_id>/', views.scan_detail, name='scan_detail'),
    path('scan/<uuid:scan_id>/perform/', views.perform_scan, name='perform_scan'),
    path('scan/<uuid:scan_id>/clean/', views.clean_file, name='clean_file'),
    
    # Activity logs (staff only)
    path('logs/', views.activity_log_view, name='activity_logs'),
    
    # Test malware generation (staff/superuser only)
    path('test/generate/', views.test_malware_generate, name='test_generate'),
    path('test/samples/', views.test_samples_list, name='test_samples'),
    path('test/download/<uuid:sample_id>/', views.download_test_sample, name='download_test_sample'),
    
    # Signature management (staff only)
    path('signatures/', views.manage_signatures, name='manage_signatures'),
]

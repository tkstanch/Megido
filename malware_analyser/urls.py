"""
MALWARE ANALYSER URL CONFIGURATION
"""

from django.urls import path
from . import views
from browser.views import launch_pyqt_browser

app_name = 'malware_analyser'

urlpatterns = [
    # Dashboard
    path('', views.dashboard, name='dashboard'),
    
    # File upload and scanning
    path('upload/', views.upload_file, name='upload_file'),
    path('scan/<uuid:file_id>/', views.scan_file, name='scan_file'),
    path('results/<uuid:scan_id>/', views.scan_results, name='scan_results'),
    path('clean/<uuid:file_id>/', views.clean_file, name='clean_file'),
    
    # Test malware creation (staff/superuser only)
    path('test-malware/create/', views.create_test_malware, name='create_test_malware'),
    path('test-malware/<uuid:artifact_id>/', views.test_artifact_details, name='test_artifact_details'),
    
    # Signature management (staff/superuser only)
    path('signatures/', views.manage_signatures, name='manage_signatures'),
    path('api/launch-desktop-browser/', launch_pyqt_browser, name='launch_desktop_browser'),
]

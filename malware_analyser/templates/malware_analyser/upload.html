{% extends "base.html" %}
{% load static %}

{% block title %}Upload File - Malware Analyser{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto space-y-6">
    <!-- Breadcrumb -->
    <nav class="flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400">
        <a href="/" class="hover:text-primary-600 dark:hover:text-primary-400">Megido Security</a>
        <span>/</span>
        <a href="{% url 'malware_analyser:dashboard' %}" class="hover:text-primary-600 dark:hover:text-primary-400">Malware Analyser</a>
        <span>/</span>
        <span class="text-gray-900 dark:text-white font-medium">Upload File</span>
    </nav>

    <!-- Page Title -->
    <div class="card">
        <div class="card-body text-center">
            <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-2">üì§ Upload File for Scanning</h1>
            <p class="text-gray-600 dark:text-gray-400">Upload a file to scan for malware signatures and patterns</p>
        </div>
    </div>
    
    <!-- Safety Warning -->
    <div class="alert alert-danger">
        <h5 class="font-bold text-lg mb-2">‚ö†Ô∏è CRITICAL SAFETY AND LEGAL WARNINGS ‚ö†Ô∏è</h5>
        <ul class="list-disc list-inside space-y-1">
            <li><strong>EDUCATIONAL USE ONLY:</strong> This malware scanner is for educational and demonstration purposes only</li>
            <li><strong>NOT FOR PRODUCTION:</strong> Never use this for production malware analysis or with real malicious files outside a secure sandbox</li>
            <li><strong>LEGAL COMPLIANCE:</strong> Ensure you have proper authorization before analyzing any files</li>
            <li><strong>CONTROLLED ENVIRONMENT:</strong> Use only in isolated, authorized testing environments</li>
            <li><strong>NO LIABILITY:</strong> Users are responsible for compliance with all applicable laws and regulations</li>
        </ul>
    </div>
    
    <div class="alert alert-info">
        <h5 class="font-bold text-lg mb-2">About File Scanning</h5>
        <ul class="list-disc list-inside space-y-1">
            <li>All file types are accepted for scanning</li>
            <li><strong>Real Detection:</strong> This system uses ClamAV antivirus engine for real malware detection</li>
            <li>Files are scanned but never executed - analysis is static only</li>
            <li>Uploaded files are stored securely with UUID filenames</li>
            <li>If ClamAV is unavailable, basic detection patterns are used</li>
            <li>Test with EICAR test file for safe positive detection: <code class="bg-gray-100 dark:bg-gray-800 px-1 rounded">X5O!P%@AP[4\PZX54(P^)7CC)7}$EICAR-STANDARD-ANTIVIRUS-TEST-FILE!$H+H*</code></li>
        </ul>
    </div>
    
    <div class="max-w-3xl mx-auto">
        <div class="card">
            <div class="card-header">
                <h5>Select File to Upload</h5>
            </div>
            <div class="card-body">
                <form method="post" enctype="multipart/form-data" class="space-y-4">
                    {% csrf_token %}
                    
                    <div>
                        <label for="{{ form.file.id_for_label }}" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2">
                            {{ form.file.label }}
                        </label>
                        {{ form.file }}
                        {% if form.file.help_text %}
                        <p class="text-sm text-gray-500 dark:text-gray-400 mt-1">{{ form.file.help_text }}</p>
                        {% endif %}
                        {% if form.file.errors %}
                        <div class="text-red-600 dark:text-red-400 text-sm mt-1">
                            {% for error in form.file.errors %}
                            <p>{{ error }}</p>
                            {% endfor %}
                        </div>
                        {% endif %}
                    </div>
                    
                    <div class="alert alert-warning">
                        <strong>Note:</strong> Files will be scanned using ClamAV antivirus engine (if available) plus signature and heuristic detection.
                    </div>
                    
                    <div class="space-y-3">
                        <button type="submit" class="btn btn-primary w-full text-lg py-3">
                            üì§ Upload and Scan
                        </button>
                        <a href="{% url 'malware_analyser:dashboard' %}" class="btn btn-secondary w-full">
                            Cancel
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}

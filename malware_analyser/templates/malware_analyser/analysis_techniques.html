{% extends "base.html" %}
{% load static %}

{% block title %}Analysis Techniques - Malware Analyser{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto space-y-6">
    <!-- Breadcrumb -->
    <nav class="flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400">
        <a href="/" class="hover:text-primary-600 dark:hover:text-primary-400">Megido Security</a>
        <span>/</span>
        <a href="{% url 'malware_analyser:dashboard' %}" class="hover:text-primary-600 dark:hover:text-primary-400">Malware Analyser</a>
        <span>/</span>
        <span class="text-gray-900 dark:text-white font-medium">Analysis Techniques</span>
    </nav>

    <!-- Header -->
    <div class="card">
        <div class="card-body text-center">
            <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-2">üî¨ Analysis Techniques</h1>
            <p class="text-gray-600 dark:text-gray-400">Comprehensive guide to malware analysis methodologies</p>
        </div>
    </div>

    <!-- Basic Static Analysis -->
    <div class="card">
        <div class="card-header bg-gradient-to-r from-blue-500 to-blue-600 text-white">
            <h5 class="text-white">üìÑ Basic Static Analysis</h5>
            <p class="text-sm text-blue-100 mt-1">Analyze without executing - file properties, strings, headers</p>
        </div>
        <div class="card-body">
            {% if basic_static %}
            <div class="space-y-4">
                {% for technique in basic_static %}
                <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
                    <h6 class="font-semibold text-gray-900 dark:text-white mb-2">{{ technique.name }}</h6>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">{{ technique.description }}</p>
                    
                    <div class="bg-gray-50 dark:bg-gray-800 rounded p-3 mb-3">
                        <p class="text-xs font-semibold text-gray-700 dark:text-gray-300 mb-1">Step-by-Step Guidance:</p>
                        <pre class="text-xs text-gray-600 dark:text-gray-400 whitespace-pre-wrap">{{ technique.guidance }}</pre>
                    </div>
                    
                    {% if technique.tools_required %}
                    <div class="flex flex-wrap gap-2">
                        <span class="text-xs text-gray-500 dark:text-gray-400">Tools:</span>
                        {% for tool in technique.tools_required %}
                        <span class="badge badge-secondary text-xs">{{ tool }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="text-gray-500 dark:text-gray-400">No techniques defined. Run <code>python manage.py populate_malware_data</code> to create them.</p>
            {% endif %}
        </div>
    </div>

    <!-- Basic Dynamic Analysis -->
    <div class="card">
        <div class="card-header bg-gradient-to-r from-green-500 to-green-600 text-white">
            <h5 class="text-white">‚ñ∂Ô∏è Basic Dynamic Analysis</h5>
            <p class="text-sm text-green-100 mt-1">Execute and observe - process, network, file system monitoring</p>
        </div>
        <div class="card-body">
            {% if basic_dynamic %}
            <div class="space-y-4">
                {% for technique in basic_dynamic %}
                <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
                    <h6 class="font-semibold text-gray-900 dark:text-white mb-2">{{ technique.name }}</h6>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">{{ technique.description }}</p>
                    
                    <div class="bg-gray-50 dark:bg-gray-800 rounded p-3 mb-3">
                        <p class="text-xs font-semibold text-gray-700 dark:text-gray-300 mb-1">Step-by-Step Guidance:</p>
                        <pre class="text-xs text-gray-600 dark:text-gray-400 whitespace-pre-wrap">{{ technique.guidance }}</pre>
                    </div>
                    
                    {% if technique.tools_required %}
                    <div class="flex flex-wrap gap-2">
                        <span class="text-xs text-gray-500 dark:text-gray-400">Tools:</span>
                        {% for tool in technique.tools_required %}
                        <span class="badge badge-secondary text-xs">{{ tool }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="text-gray-500 dark:text-gray-400">No techniques defined.</p>
            {% endif %}
        </div>
    </div>

    <!-- Advanced Static Analysis -->
    <div class="card">
        <div class="card-header bg-gradient-to-r from-purple-500 to-purple-600 text-white">
            <h5 class="text-white">üîç Advanced Static Analysis</h5>
            <p class="text-sm text-purple-100 mt-1">Deep code analysis - disassembly, decompilation, YARA rules</p>
        </div>
        <div class="card-body">
            {% if advanced_static %}
            <div class="space-y-4">
                {% for technique in advanced_static %}
                <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
                    <h6 class="font-semibold text-gray-900 dark:text-white mb-2">{{ technique.name }}</h6>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">{{ technique.description }}</p>
                    
                    <div class="bg-gray-50 dark:bg-gray-800 rounded p-3 mb-3">
                        <p class="text-xs font-semibold text-gray-700 dark:text-gray-300 mb-1">Step-by-Step Guidance:</p>
                        <pre class="text-xs text-gray-600 dark:text-gray-400 whitespace-pre-wrap">{{ technique.guidance }}</pre>
                    </div>
                    
                    {% if technique.tools_required %}
                    <div class="flex flex-wrap gap-2">
                        <span class="text-xs text-gray-500 dark:text-gray-400">Tools:</span>
                        {% for tool in technique.tools_required %}
                        <span class="badge badge-secondary text-xs">{{ tool }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="text-gray-500 dark:text-gray-400">No techniques defined.</p>
            {% endif %}
        </div>
    </div>

    <!-- Advanced Dynamic Analysis -->
    <div class="card">
        <div class="card-header bg-gradient-to-r from-red-500 to-red-600 text-white">
            <h5 class="text-white">üöÄ Advanced Dynamic Analysis</h5>
            <p class="text-sm text-red-100 mt-1">Deep runtime analysis - API hooking, memory forensics, anti-analysis detection</p>
        </div>
        <div class="card-body">
            {% if advanced_dynamic %}
            <div class="space-y-4">
                {% for technique in advanced_dynamic %}
                <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
                    <h6 class="font-semibold text-gray-900 dark:text-white mb-2">{{ technique.name }}</h6>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">{{ technique.description }}</p>
                    
                    <div class="bg-gray-50 dark:bg-gray-800 rounded p-3 mb-3">
                        <p class="text-xs font-semibold text-gray-700 dark:text-gray-300 mb-1">Step-by-Step Guidance:</p>
                        <pre class="text-xs text-gray-600 dark:text-gray-400 whitespace-pre-wrap">{{ technique.guidance }}</pre>
                    </div>
                    
                    {% if technique.tools_required %}
                    <div class="flex flex-wrap gap-2">
                        <span class="text-xs text-gray-500 dark:text-gray-400">Tools:</span>
                        {% for tool in technique.tools_required %}
                        <span class="badge badge-secondary text-xs">{{ tool }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
            {% else %}
            <p class="text-gray-500 dark:text-gray-400">No techniques defined.</p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

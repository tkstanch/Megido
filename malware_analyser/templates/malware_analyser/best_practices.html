{% extends "base.html" %}
{% load static %}

{% block title %}Best Practices - Malware Analyser{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto space-y-6">
    <!-- Breadcrumb -->
    <nav class="flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400">
        <a href="/" class="hover:text-primary-600 dark:hover:text-primary-400">Megido Security</a>
        <span>/</span>
        <a href="{% url 'malware_analyser:dashboard' %}" class="hover:text-primary-600 dark:hover:text-primary-400">Malware Analyser</a>
        <span>/</span>
        <span class="text-gray-900 dark:text-white font-medium">Best Practices</span>
    </nav>

    <!-- Header -->
    <div class="card">
        <div class="card-body text-center">
            <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-2">üõ°Ô∏è Safety Best Practices</h1>
            <p class="text-gray-600 dark:text-gray-400">Essential safety guidelines for secure malware analysis</p>
        </div>
    </div>

    <!-- Critical Warning -->
    <div class="alert alert-error">
        <h5 class="font-bold text-lg mb-2">‚ö†Ô∏è MANDATORY SAFETY REQUIREMENTS ‚ö†Ô∏è</h5>
        <p class="mb-2">Before performing ANY malware analysis, you MUST:</p>
        <ul class="list-disc list-inside space-y-1 text-sm">
            <li>Use isolated virtual machines (never your host system)</li>
            <li>Disconnect from networks or use isolated networks</li>
            <li>Create VM snapshots before analysis</li>
            <li>Have proper authorization for analysis activities</li>
        </ul>
    </div>

    <!-- Mandatory Practices -->
    {% if mandatory_practices %}
    <div class="card border-red-500 dark:border-red-700">
        <div class="card-header bg-red-50 dark:bg-red-900/20">
            <h5 class="text-red-900 dark:text-red-100">üö® Mandatory Safety Practices</h5>
            <p class="text-sm text-red-800 dark:text-red-200 mt-1">These practices MUST be followed before analysis</p>
        </div>
        <div class="card-body">
            <div class="space-y-4">
                {% for practice in mandatory_practices %}
                <div class="border-l-4 border-red-500 bg-red-50 dark:bg-red-900/10 p-4">
                    <div class="flex items-center justify-between mb-2">
                        <h6 class="font-semibold text-gray-900 dark:text-white">{{ practice.title }}</h6>
                        <span class="badge badge-error">{{ practice.get_severity_display }}</span>
                    </div>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">{{ practice.description }}</p>
                    
                    {% if practice.checklist_items %}
                    <div class="bg-white dark:bg-gray-800 rounded p-3">
                        <p class="text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2">Checklist:</p>
                        <ul class="space-y-1">
                            {% for item in practice.checklist_items %}
                            <li class="flex items-start space-x-2 text-sm text-gray-600 dark:text-gray-400">
                                <span class="text-red-500">‚òê</span>
                                <span>{{ item }}</span>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Practices by Category -->
    {% for category, practices in practices_by_category.items %}
    <div class="card">
        <div class="card-header">
            <h5>{{ practices.0.get_category_display }}</h5>
        </div>
        <div class="card-body">
            <div class="space-y-4">
                {% for practice in practices %}
                <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
                    <div class="flex items-center justify-between mb-2">
                        <h6 class="font-semibold text-gray-900 dark:text-white">{{ practice.title }}</h6>
                        <span class="badge 
                            {% if practice.severity == 'critical' %}badge-error
                            {% elif practice.severity == 'high' %}badge-warning
                            {% elif practice.severity == 'medium' %}badge-info
                            {% else %}badge-secondary{% endif %}">
                            {{ practice.get_severity_display }}
                        </span>
                    </div>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-3">{{ practice.description }}</p>
                    
                    {% if practice.checklist_items %}
                    <div class="bg-gray-50 dark:bg-gray-800 rounded p-3">
                        <p class="text-xs font-semibold text-gray-700 dark:text-gray-300 mb-2">Checklist:</p>
                        <ul class="space-y-1">
                            {% for item in practice.checklist_items %}
                            <li class="flex items-start space-x-2 text-sm text-gray-600 dark:text-gray-400">
                                <span class="text-primary-500">‚òê</span>
                                <span>{{ item }}</span>
                            </li>
                            {% endfor %}
                        </ul>
                    </div>
                    {% endif %}
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
    {% empty %}
    <div class="card">
        <div class="card-body text-center">
            <p class="text-gray-500 dark:text-gray-400">No best practices defined yet.</p>
            <p class="text-sm text-gray-400 dark:text-gray-500 mt-2">Run <code>python manage.py populate_malware_data</code> to create them.</p>
        </div>
    </div>
    {% endfor %}

    <!-- Additional Resources -->
    <div class="card bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800">
        <div class="card-body">
            <h5 class="font-semibold text-blue-900 dark:text-blue-100 mb-3">üìö Additional Resources</h5>
            <ul class="space-y-2 text-sm text-blue-800 dark:text-blue-200">
                <li>‚Ä¢ <a href="https://www.sans.org/white-papers/" target="_blank" class="underline">SANS Malware Analysis Papers</a></li>
                <li>‚Ä¢ <a href="https://www.virustotal.com/" target="_blank" class="underline">VirusTotal - Online Malware Analysis</a></li>
                <li>‚Ä¢ <a href="https://github.com/rshipp/awesome-malware-analysis" target="_blank" class="underline">Awesome Malware Analysis Resources</a></li>
                <li>‚Ä¢ <a href="https://www.malware-traffic-analysis.net/" target="_blank" class="underline">Malware Traffic Analysis Exercises</a></li>
            </ul>
        </div>
    </div>
</div>
{% endblock %}

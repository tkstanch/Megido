{% extends "base.html" %}
{% load static %}

{% block title %}Analysis Goals - Malware Analyser{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto space-y-6">
    <!-- Breadcrumb -->
    <nav class="flex items-center space-x-2 text-sm text-gray-600 dark:text-gray-400">
        <a href="/" class="hover:text-primary-600 dark:hover:text-primary-400">Megido Security</a>
        <span>/</span>
        <a href="{% url 'malware_analyser:dashboard' %}" class="hover:text-primary-600 dark:hover:text-primary-400">Malware Analyser</a>
        <span>/</span>
        <span class="text-gray-900 dark:text-white font-medium">Analysis Goals</span>
    </nav>

    <!-- Header -->
    <div class="card">
        <div class="card-body text-center">
            <h1 class="text-3xl font-bold text-gray-900 dark:text-white mb-2">ðŸŽ¯ Analysis Goals</h1>
            <p class="text-gray-600 dark:text-gray-400">Define objectives and success criteria for malware analysis</p>
        </div>
    </div>

    <!-- Default Goals -->
    {% if default_goals %}
    <div class="card">
        <div class="card-header">
            <h5>âœ… Default Analysis Goals</h5>
            <p class="text-sm text-gray-600 dark:text-gray-400 mt-1">These goals are automatically applied to new analyses</p>
        </div>
        <div class="card-body">
            <div class="grid gap-4 md:grid-cols-2">
                {% for goal in default_goals %}
                <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4">
                    <div class="flex items-start justify-between mb-2">
                        <h6 class="font-semibold text-gray-900 dark:text-white">{{ goal.name }}</h6>
                        <span class="badge 
                            {% if goal.priority == 1 %}badge-error
                            {% elif goal.priority == 2 %}badge-warning
                            {% elif goal.priority == 3 %}badge-info
                            {% else %}badge-secondary{% endif %}">
                            {% if goal.priority == 1 %}Critical
                            {% elif goal.priority == 2 %}High
                            {% elif goal.priority == 3 %}Medium
                            {% else %}Low{% endif %}
                        </span>
                    </div>
                    <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">{{ goal.description }}</p>
                    <span class="badge badge-primary">{{ goal.get_goal_type_display }}</span>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>
    {% endif %}

    <!-- All Goals -->
    <div class="card">
        <div class="card-header">
            <h5>ðŸ“‹ All Available Goals</h5>
        </div>
        <div class="card-body">
            <div class="space-y-3">
                {% for goal in goals %}
                <div class="border border-gray-200 dark:border-gray-700 rounded-lg p-4 hover:border-primary-500 transition-colors">
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <div class="flex items-center space-x-2 mb-2">
                                <h6 class="font-semibold text-gray-900 dark:text-white">{{ goal.name }}</h6>
                                {% if goal.is_default %}
                                <span class="badge badge-success text-xs">Default</span>
                                {% endif %}
                            </div>
                            <p class="text-sm text-gray-600 dark:text-gray-400 mb-2">{{ goal.description }}</p>
                            <div class="flex items-center space-x-2">
                                <span class="badge badge-primary text-xs">{{ goal.get_goal_type_display }}</span>
                                <span class="badge 
                                    {% if goal.priority == 1 %}badge-error
                                    {% elif goal.priority == 2 %}badge-warning
                                    {% elif goal.priority == 3 %}badge-info
                                    {% else %}badge-secondary{% endif %} text-xs">
                                    Priority: {% if goal.priority == 1 %}Critical
                                    {% elif goal.priority == 2 %}High
                                    {% elif goal.priority == 3 %}Medium
                                    {% else %}Low{% endif %}
                                </span>
                            </div>
                        </div>
                    </div>
                </div>
                {% empty %}
                <div class="text-center py-8 text-gray-500 dark:text-gray-400">
                    <p>No analysis goals defined yet.</p>
                    <p class="text-sm mt-2">Run <code>python manage.py populate_malware_data</code> to create default goals.</p>
                </div>
                {% endfor %}
            </div>
        </div>
    </div>

    <!-- Help Section -->
    <div class="card bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800">
        <div class="card-body">
            <h5 class="font-semibold text-blue-900 dark:text-blue-100 mb-2">ðŸ’¡ About Analysis Goals</h5>
            <p class="text-sm text-blue-800 dark:text-blue-200">
                Analysis goals help guide your malware investigation and define what you want to achieve. 
                Common goals include identifying the malware type, understanding its functionality, extracting 
                IOCs for defense, and determining attribution. Setting clear goals at the start helps ensure 
                a thorough and focused analysis.
            </p>
        </div>
    </div>
</div>
{% endblock %}

{% extends "base.html" %}

{% block title %}{{ title }} - Megido Security{% endblock %}

{% block content %}
<div class="container mt-4">
    <!-- Critical Warning Banner -->
    <div class="alert alert-danger" role="alert">
        <h4 class="alert-heading"><i class="bi bi-exclamation-triangle-fill"></i> CRITICAL SECURITY WARNING</h4>
        <hr>
        <p><strong>STUB IMPLEMENTATION - FOR EDUCATIONAL/TESTING PURPOSES ONLY</strong></p>
        <ul>
            <li>This is NOT a functional malware analysis system</li>
            <li>Does NOT provide actual malware detection or removal</li>
            <li>All scanning and cleaning functions are PLACEHOLDERS</li>
            <li>NEVER use with real malware in production</li>
            <li>Real implementation requires professional security tools and legal authorization</li>
        </ul>
    </div>

    <h1>{{ title }}</h1>
    <p class="lead">Educational malware analysis demonstration (Stub Implementation)</p>

    <div class="row mt-4">
        <div class="col-md-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Upload File</h5>
                    <p class="card-text">Upload a file for malware analysis (stub scanning only)</p>
                    <a href="{% url 'malware_analyser:upload' %}" class="btn btn-primary">Upload File</a>
                </div>
            </div>
        </div>

        <div class="col-md-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Scan History</h5>
                    <p class="card-text">View your previous malware scans</p>
                    <a href="{% url 'malware_analyser:history' %}" class="btn btn-secondary">View History</a>
                </div>
            </div>
        </div>

        {% if user.is_staff %}
        <div class="col-md-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Admin Tools</h5>
                    <p class="card-text">Manage signatures and test samples</p>
                    <a href="{% url 'malware_analyser:manage_signatures' %}" class="btn btn-warning">Signatures</a>
                    <a href="{% url 'malware_analyser:test_samples' %}" class="btn btn-info">Test Samples</a>
                </div>
            </div>
        </div>
        {% endif %}
    </div>

    {% if recent_scans %}
    <div class="mt-5">
        <h3>Recent Scans</h3>
        <div class="table-responsive">
            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>File Name</th>
                        <th>Scanned At</th>
                        <th>Status</th>
                        <th>Threat</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for scan in recent_scans %}
                    <tr>
                        <td>{{ scan.file_name }}</td>
                        <td>{{ scan.scanned_at|date:"Y-m-d H:i" }}</td>
                        <td><span class="badge bg-info">{{ scan.scan_status }}</span></td>
                        <td>
                            {% if scan.threat_detected %}
                                <span class="badge bg-danger">Detected</span>
                            {% else %}
                                <span class="badge bg-success">Clean</span>
                            {% endif %}
                        </td>
                        <td>
                            <a href="{% url 'malware_analyser:scan_detail' scan.scan_id %}" class="btn btn-sm btn-primary">Details</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    {% endif %}

    <!-- Implementation Notes -->
    <div class="mt-5">
        <div class="card bg-light">
            <div class="card-body">
                <h5 class="card-title">Implementation Requirements for Production</h5>
                <ul>
                    <li>Integrate with professional antivirus engines (ClamAV, VirusTotal API, etc.)</li>
                    <li>Implement proper sandboxing and isolation (VM-based, containerized)</li>
                    <li>Use secure file handling and storage with encryption</li>
                    <li>Implement comprehensive logging and audit trails</li>
                    <li>Follow security best practices (OWASP, NIST guidelines)</li>
                    <li>Ensure legal compliance and obtain necessary authorizations</li>
                    <li>Regular signature updates from threat intelligence feeds</li>
                    <li>Behavioral analysis and heuristic detection capabilities</li>
                </ul>
            </div>
        </div>
    </div>
</div>
{% endblock %}

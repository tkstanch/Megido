# Generated by Django 6.0.2 on 2026-02-26 17:18

import django.db.models.deletion
import django.utils.timezone
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('forensics', '0001_initial'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='HashSet',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True)),
                ('hash_type', models.CharField(default='sha256', max_length=20)),
                ('source', models.CharField(blank=True, max_length=255)),
                ('entry_count', models.IntegerField(default=0)),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now)),
            ],
            options={
                'verbose_name': 'Hash Set',
                'verbose_name_plural': 'Hash Sets',
                'ordering': ['name'],
            },
        ),
        migrations.CreateModel(
            name='YARARule',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255, unique=True)),
                ('description', models.TextField(blank=True)),
                ('rule_content', models.TextField()),
                ('tags', models.CharField(blank=True, max_length=500)),
                ('author', models.CharField(blank=True, max_length=255)),
                ('is_active', models.BooleanField(default=True)),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'YARA Rule',
                'verbose_name_plural': 'YARA Rules',
                'ordering': ['name'],
            },
        ),
        migrations.AddField(
            model_name='forensicfile',
            name='analysis_complete',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='forensicfile',
            name='embedded_files_count',
            field=models.IntegerField(default=0),
        ),
        migrations.AddField(
            model_name='forensicfile',
            name='entropy',
            field=models.FloatField(blank=True, null=True),
        ),
        migrations.AddField(
            model_name='forensicfile',
            name='is_encrypted',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='forensicfile',
            name='is_packed',
            field=models.BooleanField(default=False),
        ),
        migrations.AddField(
            model_name='forensicfile',
            name='magic_bytes',
            field=models.CharField(blank=True, max_length=100),
        ),
        migrations.AddField(
            model_name='forensicfile',
            name='sha1_hash',
            field=models.CharField(blank=True, max_length=40),
        ),
        migrations.AddField(
            model_name='forensicfile',
            name='sha512_hash',
            field=models.CharField(blank=True, max_length=128),
        ),
        migrations.AddField(
            model_name='forensicfile',
            name='yara_matches',
            field=models.TextField(blank=True),
        ),
        migrations.AlterField(
            model_name='forensicfile',
            name='hex_sample',
            field=models.TextField(blank=True),
        ),
        migrations.CreateModel(
            name='EvidenceItem',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('name', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True)),
                ('acquisition_type', models.CharField(choices=[('live', 'Live Acquisition'), ('dead', 'Dead-box Acquisition'), ('network', 'Network Acquisition'), ('cloud', 'Cloud Acquisition'), ('logical', 'Logical Acquisition'), ('physical', 'Physical Acquisition')], default='logical', max_length=20)),
                ('acquisition_timestamp', models.DateTimeField(default=django.utils.timezone.now)),
                ('storage_location', models.CharField(blank=True, max_length=500)),
                ('sha256_hash', models.CharField(blank=True, max_length=64)),
                ('md5_hash', models.CharField(blank=True, max_length=32)),
                ('file_size', models.BigIntegerField(blank=True, null=True)),
                ('integrity_verified', models.BooleanField(default=False)),
                ('last_verified', models.DateTimeField(blank=True, null=True)),
                ('notes', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('acquired_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Evidence Item',
                'verbose_name_plural': 'Evidence Items',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='ChainOfCustodyEntry',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('action', models.CharField(max_length=255)),
                ('timestamp', models.DateTimeField(default=django.utils.timezone.now)),
                ('location', models.CharField(blank=True, max_length=255)),
                ('notes', models.TextField(blank=True)),
                ('digital_signature', models.TextField(blank=True)),
                ('performed_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
                ('evidence', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='custody_entries', to='forensics.evidenceitem')),
            ],
            options={
                'verbose_name': 'Chain of Custody Entry',
                'verbose_name_plural': 'Chain of Custody Entries',
                'ordering': ['timestamp'],
            },
        ),
        migrations.CreateModel(
            name='Artifact',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('artifact_type', models.CharField(choices=[('registry_key', 'Registry Key'), ('browser_history', 'Browser History'), ('email', 'Email'), ('document', 'Document'), ('image', 'Image'), ('executable', 'Executable'), ('prefetch', 'Prefetch File'), ('lnk', 'LNK File'), ('event_log', 'Event Log Entry'), ('usb_device', 'USB Device'), ('network_connection', 'Network Connection'), ('user_account', 'User Account'), ('installed_software', 'Installed Software'), ('other', 'Other')], max_length=30)),
                ('name', models.CharField(max_length=500)),
                ('value', models.TextField(blank=True)),
                ('path', models.CharField(blank=True, max_length=1000)),
                ('timestamp', models.DateTimeField(blank=True, null=True)),
                ('extra_data', models.TextField(blank=True)),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('forensic_file', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='artifacts', to='forensics.forensicfile')),
                ('evidence_item', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='artifacts', to='forensics.evidenceitem')),
            ],
            options={
                'verbose_name': 'Artifact',
                'verbose_name_plural': 'Artifacts',
                'ordering': ['-created_at'],
            },
        ),
        migrations.CreateModel(
            name='AnalysisTask',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('task_type', models.CharField(choices=[('disk', 'Disk Analysis'), ('memory', 'Memory Analysis'), ('network', 'Network Analysis'), ('timeline', 'Timeline Generation'), ('ioc', 'IOC Extraction'), ('yara', 'YARA Scan'), ('hash', 'Hash Verification'), ('report', 'Report Generation')], max_length=20)),
                ('status', models.CharField(choices=[('pending', 'Pending'), ('running', 'Running'), ('completed', 'Completed'), ('failed', 'Failed'), ('cancelled', 'Cancelled')], default='pending', max_length=20)),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('started_at', models.DateTimeField(blank=True, null=True)),
                ('completed_at', models.DateTimeField(blank=True, null=True)),
                ('celery_task_id', models.CharField(blank=True, max_length=255)),
                ('result_summary', models.TextField(blank=True)),
                ('error_message', models.TextField(blank=True)),
                ('progress_percent', models.IntegerField(default=0)),
                ('forensic_file', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='tasks', to='forensics.forensicfile')),
                ('evidence_item', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='tasks', to='forensics.evidenceitem')),
            ],
            options={
                'verbose_name': 'Analysis Task',
                'verbose_name_plural': 'Analysis Tasks',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddField(
            model_name='forensicfile',
            name='evidence_item',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='files', to='forensics.evidenceitem'),
        ),
        migrations.CreateModel(
            name='ForensicCase',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('case_number', models.CharField(max_length=50, unique=True)),
                ('title', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True)),
                ('status', models.CharField(choices=[('open', 'Open'), ('active', 'Active'), ('closed', 'Closed'), ('archived', 'Archived')], default='open', max_length=20)),
                ('classification', models.CharField(choices=[('unclassified', 'Unclassified'), ('confidential', 'Confidential'), ('secret', 'Secret'), ('top_secret', 'Top Secret')], default='unclassified', max_length=20)),
                ('created_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('updated_at', models.DateTimeField(auto_now=True)),
                ('tags', models.CharField(blank=True, max_length=500)),
                ('investigator', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='cases', to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Forensic Case',
                'verbose_name_plural': 'Forensic Cases',
                'ordering': ['-created_at'],
            },
        ),
        migrations.AddField(
            model_name='evidenceitem',
            name='case',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='evidence_items', to='forensics.forensiccase'),
        ),
        migrations.AddField(
            model_name='forensicfile',
            name='case',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='files', to='forensics.forensiccase'),
        ),
        migrations.CreateModel(
            name='ForensicReport',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('report_type', models.CharField(choices=[('executive', 'Executive Summary'), ('technical', 'Full Technical Report'), ('ioc', 'IOC Report'), ('timeline', 'Timeline Report'), ('chain_of_custody', 'Chain of Custody Report')], default='technical', max_length=20)),
                ('format', models.CharField(choices=[('pdf', 'PDF'), ('html', 'HTML'), ('json', 'JSON'), ('csv', 'CSV')], default='pdf', max_length=10)),
                ('title', models.CharField(max_length=255)),
                ('generated_at', models.DateTimeField(default=django.utils.timezone.now)),
                ('file_path', models.CharField(blank=True, max_length=1000)),
                ('summary', models.TextField(blank=True)),
                ('case', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='reports', to='forensics.forensiccase')),
                ('generated_by', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Forensic Report',
                'verbose_name_plural': 'Forensic Reports',
                'ordering': ['-generated_at'],
            },
        ),
        migrations.CreateModel(
            name='NetworkConnection',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('src_ip', models.GenericIPAddressField(blank=True, null=True)),
                ('src_port', models.IntegerField(blank=True, null=True)),
                ('dst_ip', models.GenericIPAddressField(blank=True, null=True)),
                ('dst_port', models.IntegerField(blank=True, null=True)),
                ('protocol', models.CharField(choices=[('tcp', 'TCP'), ('udp', 'UDP'), ('icmp', 'ICMP'), ('http', 'HTTP'), ('https', 'HTTPS'), ('dns', 'DNS'), ('ftp', 'FTP'), ('smtp', 'SMTP'), ('ssh', 'SSH'), ('smb', 'SMB'), ('other', 'Other')], default='tcp', max_length=10)),
                ('state', models.CharField(blank=True, max_length=50)),
                ('process_name', models.CharField(blank=True, max_length=255)),
                ('pid', models.IntegerField(blank=True, null=True)),
                ('timestamp', models.DateTimeField(blank=True, null=True)),
                ('bytes_sent', models.BigIntegerField(blank=True, null=True)),
                ('bytes_received', models.BigIntegerField(blank=True, null=True)),
                ('geo_country', models.CharField(blank=True, max_length=100)),
                ('geo_city', models.CharField(blank=True, max_length=100)),
                ('evidence_item', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='network_connections', to='forensics.evidenceitem')),
                ('forensic_file', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='network_connections', to='forensics.forensicfile')),
            ],
            options={
                'verbose_name': 'Network Connection',
                'verbose_name_plural': 'Network Connections',
                'ordering': ['-timestamp'],
            },
        ),
        migrations.CreateModel(
            name='ProcessInfo',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('pid', models.IntegerField()),
                ('ppid', models.IntegerField(blank=True, null=True)),
                ('name', models.CharField(max_length=255)),
                ('path', models.CharField(blank=True, max_length=1000)),
                ('command_line', models.TextField(blank=True)),
                ('username', models.CharField(blank=True, max_length=255)),
                ('start_time', models.DateTimeField(blank=True, null=True)),
                ('exit_time', models.DateTimeField(blank=True, null=True)),
                ('is_hidden', models.BooleanField(default=False)),
                ('is_injected', models.BooleanField(default=False)),
                ('dll_list', models.TextField(blank=True)),
                ('md5_hash', models.CharField(blank=True, max_length=32)),
                ('sha256_hash', models.CharField(blank=True, max_length=64)),
                ('evidence_item', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='processes', to='forensics.evidenceitem')),
                ('forensic_file', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='processes', to='forensics.forensicfile')),
            ],
            options={
                'verbose_name': 'Process Info',
                'verbose_name_plural': 'Process Info',
                'ordering': ['pid'],
            },
        ),
        migrations.CreateModel(
            name='TimelineEvent',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('event_time', models.DateTimeField()),
                ('event_type', models.CharField(choices=[('created', 'File Created'), ('modified', 'File Modified'), ('accessed', 'File Accessed'), ('deleted', 'File Deleted'), ('network', 'Network Connection'), ('process', 'Process Execution'), ('registry', 'Registry Change'), ('login', 'User Login'), ('other', 'Other')], default='other', max_length=20)),
                ('source', models.CharField(max_length=255)),
                ('description', models.TextField()),
                ('artifact_path', models.CharField(blank=True, max_length=1000)),
                ('artifact_hash', models.CharField(blank=True, max_length=64)),
                ('raw_data', models.TextField(blank=True)),
                ('evidence_item', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='timeline_events', to='forensics.evidenceitem')),
                ('forensic_file', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='timeline_events', to='forensics.forensicfile')),
            ],
            options={
                'verbose_name': 'Timeline Event',
                'verbose_name_plural': 'Timeline Events',
                'ordering': ['event_time'],
            },
        ),
        migrations.CreateModel(
            name='IOCIndicator',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('ioc_type', models.CharField(choices=[('md5', 'MD5 Hash'), ('sha1', 'SHA1 Hash'), ('sha256', 'SHA256 Hash'), ('ipv4', 'IPv4 Address'), ('ipv6', 'IPv6 Address'), ('domain', 'Domain Name'), ('url', 'URL'), ('email', 'Email Address'), ('filepath', 'File Path'), ('registry_key', 'Registry Key'), ('mutex', 'Mutex Name'), ('yara_match', 'YARA Match'), ('crypto_wallet', 'Crypto Wallet Address'), ('other', 'Other')], max_length=20)),
                ('ioc_value', models.TextField()),
                ('confidence', models.CharField(choices=[('low', 'Low'), ('medium', 'Medium'), ('high', 'High')], default='medium', max_length=10)),
                ('source', models.CharField(max_length=255)),
                ('description', models.TextField(blank=True)),
                ('first_seen', models.DateTimeField(default=django.utils.timezone.now)),
                ('last_seen', models.DateTimeField(default=django.utils.timezone.now)),
                ('mitre_technique', models.CharField(blank=True, max_length=50)),
                ('tags', models.CharField(blank=True, max_length=500)),
                ('evidence_item', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='iocs', to='forensics.evidenceitem')),
                ('forensic_file', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='iocs', to='forensics.forensicfile')),
            ],
            options={
                'verbose_name': 'IOC Indicator',
                'verbose_name_plural': 'IOC Indicators',
                'ordering': ['-first_seen'],
                'unique_together': {('ioc_type', 'ioc_value')},
            },
        ),
    ]
